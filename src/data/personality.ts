// 咖啡人格类型（20种）
export type PersonalityType = 
  | '静水流深' | '春风化雨' | '破茧成蝶' | '守拙归朴' | '云卷云舒'
  | '细水长流' | '厚积薄发' | '返璞归真' | '随遇而安' | '从容不迫'
  | '温润如玉' | '虚怀若谷' | '大智若愚' | '淡泊明志' | '宁静致远'
  | '行云流水' | '刚柔并济' | '宠辱不惊' | '去留无意' | '上善若水'

// 20种人格类型的意境句子库（每种8条）
export const personalitySentences: Record<PersonalityType, string[]> = {
  '静水流深': [
    '深潭无波，却有万千气象藏于心底。',
    '不争喧哗，自有深渊般的沉静力量。',
    '表面波澜不惊，内里早已涵泳万物。',
    '沉默是一种深度，而非空无。',
    '静水深流，岁月在其中缓慢沉淀。',
    '无需喧哗，自有回响。',
    '深者不言，言者不深。',
    '静穆之中，藏着时间的重量。'
  ],
  '春风化雨': [
    '润物无声，却能唤醒沉睡的生机。',
    '温柔是一种力量，而非软弱。',
    '如春风过境，万物悄然生长。',
    '不必张扬，自有化育之功。',
    '细腻如丝，却能穿透顽石。',
    '温润之中，藏着改变世界的耐心。',
    '不是每一阵风都要呼啸而过。',
    '默默滋养，便是最好的修行。'
  ],
  '破茧成蝶': [
    '蜕变是痛的，但翅膀是美的。',
    '旧壳破碎之处，正是新生的起点。',
    '不是每一个茧都能成蝶，但每一只蝶都曾困于茧。',
    '阵痛之后，是全新的自己。',
    '敢于撕裂旧我，才能羽化成新。',
    '美丽从来不是天生的，是挣扎出来的。',
    '茧里的黑暗，是为了照亮翅膀。',
    '蜕变不必张扬，自有蝶翼轻颤。'
  ],
  '守拙归朴': [
    '大巧若拙，返璞归真。',
    '剥去繁复，看见本质的朴素之美。',
    '笨拙是一种选择，而非无能。',
    '守住那份拙，才有归处。',
    '繁华落尽，方见真淳。',
    '不求机巧，但求心安。',
    '朴素是最难伪装的奢侈。',
    '归朴之路，即是归心之路。'
  ],
  '云卷云舒': [
    '聚散随缘，不执着于任何一种形态。',
    '如云般自在，卷舒皆是风景。',
    '不必强求停留，每一刻都是最好的形状。',
    '云淡风轻，是历经风雨后的从容。',
    '聚散有时，得失无意。',
    '在变幻中保持不变的心境。',
    '云起时不骄，云散时不馁。',
    '随气流转，却从不迷失自己。'
  ],
  '细水长流': [
    '不是每一滴水都要惊涛拍岸。',
    '缓缓流淌，却能穿石。',
    '持久的温柔，胜过短暂的激烈。',
    '细水无声，长流不息。',
    '在平淡中坚守，便是永恒。',
    '不必汹涌，自有其深远。',
    '细流汇聚，终成江海。',
    '慢慢来，是最快的路。'
  ],
  '厚积薄发': [
    '沉默的积累，是为了那一刻的绽放。',
    '厚积如冬藏，薄发如春雷。',
    '不鸣则已，一鸣惊人。',
    '所有的沉默，都是在为发声做准备。',
    '积累是无声的，爆发是有力的。',
    '深根固柢，方能枝繁叶茂。',
    '时间是最好的厚度。',
    '待发之时，正是蓄力之际。'
  ],
  '返璞归真': [
    '走过繁华，方知朴素可贵。',
    '最高级的状态，是回到最初。',
    '洗尽铅华，始见天真。',
    '归真不是倒退，是另一种进阶。',
    '丢掉多余的，留下必需的。',
    '简单，是复杂的终点。',
    '归真之路，即是归心之路。',
    '朴素，是最高级的审美。'
  ],
  '随遇而安': [
    '不挑环境，只调心境。',
    '到哪里都是修行，遇什么都是功课。',
    '随遇而安，不是妥协，是接纳。',
    '心安之处，即是吾乡。',
    '不强求，故无失。',
    '在每一个当下，找到自在。',
    '随遇而安，是一种智慧。',
    '不挑不拣，自有缘分。'
  ],
  '从容不迫': [
    '急事缓办，大事静办。',
    '从容是一种底气，而非傲慢。',
    '不迫，是因为心里有数。',
    '从容者，心有定盘星。',
    '不慌不忙，自有主张。',
    '从容，是见过风浪后的平静。',
    '不紧不慢，恰到好处。',
    '从容，是最高级的自信。'
  ],
  '温润如玉': [
    '温润是一种修养，而非天生。',
    '如玉般温润，却不失其坚。',
    '外圆内方，是为君子。',
    '温润，是岁月的打磨。',
    '不刺眼，却耐看。',
    '温润之中，藏着棱角。',
    '如玉，是不张扬的光华。',
    '温润，是一种选择。'
  ],
  '虚怀若谷': [
    '空，才能容万物。',
    '虚怀，是一种姿态，而非姿态。',
    '山谷空，故能回响。',
    '不自满，故能进步。',
    '虚怀若谷，方能纳百川。',
    '空杯心态，是最好的学习。',
    '虚怀，是另一种充盈。',
    '放下自己，看见世界。'
  ],
  '大智若愚': [
    '真正的聪明，看起来都像笨拙。',
    '大智不言，大巧不工。',
    '不炫耀，是一种智慧。',
    '愚，是为了不与人争。',
    '大智若愚，是一种保护色。',
    '看起来慢，其实是最快的路。',
    '大智，是懂得装糊涂。',
    '不显露，是最大的显露。'
  ],
  '淡泊明志': [
    '淡泊，是为了看清真正想要的。',
    '不被繁华迷眼，方能明志。',
    '淡泊，是一种主动的减法。',
    '少即是多，淡即是浓。',
    '淡泊之人，心有远方。',
    '不贪恋，故清醒。',
    '淡泊，是另一种富有。',
    '明志，必先淡泊。'
  ],
  '宁静致远': [
    '宁静，是为了走得更远。',
    '静，是一种力量。',
    '致远者，必先静心。',
    '宁静之中，听见内心的声音。',
    '不浮躁，方能行远。',
    '宁静，是远行的准备。',
    '静水深流，致远无声。',
    '宁静，是最好的出发。'
  ],
  '行云流水': [
    '如云般自在，如水般流动。',
    '不拘一格，行云流水。',
    '行云流水，是自然的最佳状态。',
    '不勉强，不造作，便是行云流水。',
    '顺势而为，如水就下。',
    '行云流水，是技艺的最高境界。',
    '不滞于物，不困于心。',
    '行云流水，是自由的模样。'
  ],
  '刚柔并济': [
    '刚能断金，柔能绕指。',
    '刚柔并济，是平衡的智慧。',
    '该刚则刚，该柔则柔。',
    '刚柔之间，藏着分寸。',
    '太刚易折，太柔则靡。',
    '刚柔并济，方能长久。',
    '柔中带刚，刚中带柔。',
    '刚柔，是一种选择。'
  ],
  '宠辱不惊': [
    '宠辱不惊，是看淡得失后的从容。',
    '得之不喜，失之不忧。',
    '宠辱皆外物，不惊是内功。',
    '不被赞美冲昏，不被批评打倒。',
    '宠辱不惊，是一种定力。',
    '平常心，是最难得的心。',
    '不惊，是因为心里有谱。',
    '宠辱不惊，是成熟的标志。'
  ],
  '去留无意': [
    '去者不留，来者不拒。',
    '去留无意，是随缘的智慧。',
    '不执着于拥有，不恐惧于失去。',
    '去留之间，保持自在。',
    '无意，是最好的心态。',
    '不挽留，不强求。',
    '去留随意，心境自如。',
    '无意，是另一种有意。'
  ],
  '上善若水': [
    '水善利万物而不争。',
    '上善若水，是最高的善。',
    '处众人之所恶，故几于道。',
    '水，是智慧的化身。',
    '上善，是不争之争。',
    '如水般柔软，却穿石。',
    '水的智慧，是无形的智慧。',
    '上善若水，是修行的终点。'
  ]
}

// 稀有豆专用句子库（更克制更高级）
export const rareSentences: Record<PersonalityType, string[]> = {
  '静水流深': [
    '深潭映月，一叶可知秋。',
    '静水流深，万物归宗。',
    '深渊无言，自有气象。'
  ],
  '春风化雨': [
    '春风化雨，润物无声。',
    '细雨知时，万物生发。',
    '化雨之恩，不言而成。'
  ],
  '破茧成蝶': [
    '茧破蝶生，一瞬永恒。',
    '羽化而登仙。',
    '蜕变之美，不可言喻。'
  ],
  '守拙归朴': [
    '大巧若拙，返璞归真。',
    '朴者，天下莫能与之争。',
    '守拙，是最高级的聪明。'
  ],
  '云卷云舒': [
    '云卷云舒，任其自然。',
    '天际云舒，无心而成画。',
    '云起云落，皆是缘分。'
  ],
  '细水长流': [
    '细水长流，岁月沉香。',
    '涓滴成河，无声而深远。',
    '细流穿石，岁月为证。'
  ],
  '厚积薄发': [
    '厚积薄发，一鸣惊人。',
    '蓄力已久，待发之时。',
    '厚积，是为了那一刻。'
  ],
  '返璞归真': [
    '洗尽铅华，返璞归真。',
    '归真之处，即是初心。',
    '璞玉浑金，不待雕琢。'
  ],
  '随遇而安': [
    '随遇而安，处处皆安。',
    '心安处，即是归途。',
    '随遇，是一种境界。'
  ],
  '从容不迫': [
    '从容不迫，自有气度。',
    '不慌不忙，心中有数。',
    '从容，是最好的姿态。'
  ],
  '温润如玉': [
    '温润如玉，光华内敛。',
    '玉润珠圆，不言自华。',
    '温润，是一种修养。'
  ],
  '虚怀若谷': [
    '虚怀若谷，能纳百川。',
    '谷空，故能回响。',
    '虚怀，是一种智慧。'
  ],
  '大智若愚': [
    '大智若愚，大巧不工。',
    '聪明不露，才华不逞。',
    '若愚，是大智。'
  ],
  '淡泊明志': [
    '淡泊明志，宁静致远。',
    '不为繁华易素心。',
    '淡泊，是为了看清。'
  ],
  '宁静致远': [
    '宁静致远，静水流深。',
    '宁静之中，自有远方。',
    '致远，必先静心。'
  ],
  '行云流水': [
    '行云流水，自然天成。',
    '行云流水，不滞于物。',
    '行云流水，是道。'
  ],
  '刚柔并济': [
    '刚柔并济，相得益彰。',
    '刚而能柔，柔而能刚。',
    '并济，是平衡之道。'
  ],
  '宠辱不惊': [
    '宠辱不惊，闲看庭前花开。',
    '不惊，是因为笃定。',
    '宠辱皆过客。'
  ],
  '去留无意': [
    '去留无意，漫随天外云舒。',
    '无意，是最好的心态。',
    '去留，皆是缘分。'
  ],
  '上善若水': [
    '上善若水，水善利万物。',
    '水利万物而不争。',
    '上善，近乎道。'
  ]
}

// 由三维输入映射到人格类型
export function resolvePersonalityType(
  mood: 'calm' | 'expectant' | 'nostalgic' | 'hopeful',
  grindScore: number,
  brewScore: number
): PersonalityType {
  // 计算综合气质
  const isStable = grindScore >= 20 && brewScore >= 30
  const isFast = grindScore < 15 || brewScore < 25
  
  // 根据 mood 和稳定性映射
  const mapping: Record<string, PersonalityType[]> = {
    'calm-stable': ['静水流深', '宁静致远', '细水长流', '守拙归朴'],
    'calm-fast': ['随遇而安', '云卷云舒', '从容不迫'],
    'expectant-stable': ['厚积薄发', '春风化雨', '温润如玉'],
    'expectant-fast': ['破茧成蝶', '行云流水', '刚柔并济'],
    'nostalgic-stable': ['返璞归真', '守拙归朴', '虚怀若谷'],
    'nostalgic-fast': ['去留无意', '宠辱不惊', '大智若愚'],
    'hopeful-stable': ['淡泊明志', '上善若水', '宁静致远'],
    'hopeful-fast': ['破茧成蝶', '行云流水', '春风化雨']
  }
  
  const key = `${mood}-${isStable ? 'stable' : isFast ? 'fast' : 'normal'}`
  const candidates = mapping[key] || allPersonalityTypes
  
  return candidates[Math.floor(Math.random() * candidates.length)]
}

// 获取人格句子
export function getPersonalitySentence(
  type: PersonalityType,
  isRare: boolean
): { text: string; type: PersonalityType } {
  const sentences = isRare ? rareSentences[type] : personalitySentences[type]
  const randomIndex = Math.floor(Math.random() * sentences.length)
  return {
    text: sentences[randomIndex],
    type
  }
}

// 所有人格类型列表
export const allPersonalityTypes: PersonalityType[] = [
  '静水流深', '春风化雨', '破茧成蝶', '守拙归朴', '云卷云舒',
  '细水长流', '厚积薄发', '返璞归真', '随遇而安', '从容不迫',
  '温润如玉', '虚怀若谷', '大智若愚', '淡泊明志', '宁静致远',
  '行云流水', '刚柔并济', '宠辱不惊', '去留无意', '上善若水'
]
